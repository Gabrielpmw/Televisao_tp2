<div class="container">
    
    <div class="header">
        <h1>{{ titulo }}</h1>
    </div>

    <div class="form-container">
        <form [formGroup]="form" (ngSubmit)="onSubmit()">
            
            <!-- BLOCO 1: CREDENCIAIS (Apenas na Criação) -->
            <!-- *ngIf="!isEdicao" garante que não pedimos senha na edição -->
            <div class="section-title" *ngIf="!isEdicao">Credenciais de Acesso</div>
            
            <div class="grid-row" *ngIf="!isEdicao">
                <div class="form-group">
                    <label for="username">Username (Login)*</label>
                    <input type="text" id="username" formControlName="username" placeholder="Ex: joaosilva"
                           [class.invalid]="form.get('username')?.invalid && form.get('username')?.touched">
                    
                    <small *ngIf="form.get('username')?.hasError('required') && form.get('username')?.touched">
                        O username é obrigatório.
                    </small>
                </div>

                <div class="form-group">
                    <label for="senha">Senha Inicial*</label>
                    <input type="password" id="senha" formControlName="senha" placeholder="********"
                           [class.invalid]="form.get('senha')?.invalid && form.get('senha')?.touched">
                    
                    <small *ngIf="form.get('senha')?.hasError('required') && form.get('senha')?.touched">
                        A senha é obrigatória.
                    </small>
                    <small *ngIf="form.get('senha')?.hasError('minlength') && form.get('senha')?.touched">
                        A senha deve ter no mínimo 4 caracteres.
                    </small>
                </div>
            </div>

            <!-- BLOCO 2: DADOS PESSOAIS -->
            <div class="section-title">Dados Pessoais</div>
            
            <div class="grid-row">
                <div class="form-group">
                    <label for="nome">Nome*</label>
                    <input type="text" id="nome" formControlName="nome" placeholder="Nome"
                           [class.invalid]="form.get('nome')?.invalid && form.get('nome')?.touched">
                    <small *ngIf="form.get('nome')?.invalid && form.get('nome')?.touched">
                        Nome obrigatório (min 2 caracteres).
                    </small>
                </div>

                <div class="form-group">
                    <label for="sobrenome">Sobrenome*</label>
                    <input type="text" id="sobrenome" formControlName="sobrenome" placeholder="Sobrenome"
                           [class.invalid]="form.get('sobrenome')?.invalid && form.get('sobrenome')?.touched">
                    <small *ngIf="form.get('sobrenome')?.invalid && form.get('sobrenome')?.touched">
                        Sobrenome obrigatório.
                    </small>
                </div>
            </div>

            <div class="grid-row">
                <div class="form-group">
                    <label for="cpf">CPF*</label>
                    <!-- Sem pipe mask, input texto simples -->
                    <input type="text" id="cpf" formControlName="cpf" placeholder="000.000.000-00" maxlength="14"
                           [class.invalid]="form.get('cpf')?.invalid && form.get('cpf')?.touched">
                    <small *ngIf="form.get('cpf')?.invalid && form.get('cpf')?.touched">
                        CPF inválido ou incompleto.
                    </small>
                </div>

                <div class="form-group">
                    <label for="dataNascimento">Data de Nascimento</label>
                    <input type="date" id="dataNascimento" formControlName="dataNascimento">
                </div>
            </div>

            <div class="form-group full-width">
                <label for="email">E-mail</label>
                <input type="email" id="email" formControlName="email" placeholder="cliente@exemplo.com"
                       [class.invalid]="form.get('email')?.invalid && form.get('email')?.touched">
                <small *ngIf="form.get('email')?.invalid && form.get('email')?.touched">
                    E-mail inválido.
                </small>
            </div>

            <!-- BLOCO 3: CONTATO (TELEFONE) -->
            <div class="section-title">Contato</div>
            <div class="grid-row-small">
                <div class="form-group">
                    <label for="ddd">DDD</label>
                    <input type="text" id="ddd" formControlName="ddd" placeholder="63" maxlength="2"
                           [class.invalid]="form.get('ddd')?.invalid && form.get('ddd')?.touched">
                </div>
                <div class="form-group">
                    <label for="numero">Número</label>
                    <input type="text" id="numero" formControlName="numero" placeholder="999999999" maxlength="9"
                           [class.invalid]="form.get('numero')?.invalid && form.get('numero')?.touched">
                </div>
            </div>
            
            <!-- Exibe erro de validação do telefone se necessário -->
            <small *ngIf="(form.get('ddd')?.invalid || form.get('numero')?.invalid) && (form.get('ddd')?.touched || form.get('numero')?.touched)">
                Telefone inválido (Verifique DDD e Número).
            </small>

            <!-- AÇÕES -->
            <div class="form-actions">
                <button type="button" class="btn-cancel" (click)="cancelar()">Cancelar</button>
                
                <!-- Botão desabilita se o formulário estiver inválido -->
                <button type="submit" class="btn-submit" [disabled]="form.invalid">
                    {{ isEdicao ? 'Salvar Alterações' : 'Criar Cliente' }}
                </button>
            </div>

        </form>
    </div>
</div>