<div class="container">
       <div class="header">
              <h1>{{ filtroStatus === 'inativos' ? 'Lixeira de Televisões' : 'Gerenciamento de Televisões' }}</h1>
             
              <div class="header-actions">
                    <!-- 1. Botão de Alternância (Ativos vs. Inativos/Lixeira) -->
                    
<div class="container">
    <div class="header">
        <h1>{{ filtroStatus === 'inativos' ? 'Lixeira de Televisões' : 'Gerenciamento de Televisões' }}</h1>

        <div class="header-actions">
            <button class="btn-toggle"
                            [ngClass]="{'btn-secondary': filtroStatus === 'ativos', 'btn-primary': filtroStatus === 'inativos'}"
                            (click)="alternarStatusVisualizacao(filtroStatus === 'ativos' ? 'inativos' : 'ativos')">
                {{ filtroStatus === 'inativos' ? 'Voltar para Ativos' : 'Ver Excluídos (Lixeira)' }}
            </button>

            <button *ngIf="filtroStatus === 'ativos'"
                            class="btn-add"
                            [routerLink]="['/perfil-admin/televisoes/new']">
                Adicionar Televisão
            </button>
        </div>
    </div>

    <div class="search-container">
        <input type="text"
                     class="search-input"
                     placeholder="Buscar por Modelo... (Pressione Enter)"
                     [(ngModel)]="termoBusca"
                     (keydown.enter)="aplicarBusca()"
                     [disabled]="filtroStatus === 'inativos'">

        <button *ngIf="termoBusca.length > 0"
                        (click)="limparBusca()"
                        class="btn-clear-search">
            Limpar
        </button>
    </div>

    <div class="table-container">
        <table class="fabricante-table">
            <thead>
                <tr>
                    <th>No.</th>
                    <th>Marca</th>
                    <th>Modelo</th>
                    <th>Resolução</th>
                    <th>Polegada</th>
                    <th>Valor</th>
                    <th>Estoque</th>
                    <th>Status</th>
                    <th>Ações</th>
                </tr>
            </thead>

            <tbody *ngIf="televisoes.length > 0; else emptyState">
                <tr *ngFor="let tv of televisoes; let i = index">
                    <td>{{ (paginaAtual - 1) * itensPorPagina + i + 1 }}</td>
                    <td>{{ tv.marca }}</td>
                    <td>{{ tv.modelo }}</td>
                    <td>{{ tv.resolucao?.nome || 'N/A' }}</td>
                    <td>{{ tv.dimensao?.polegada || 'N/A' }}</td>
                    <td>{{ tv.valor | currency:'BRL' }}</td>
                    <td>
                        <span class="status-badge"
                                    [ngClass]="{'status-ativo': tv.estoque > 0, 'status-inativo': tv.estoque === 0}">
                            {{ tv.estoque }}
                        </span>
                    </td>
                    <td>
                        <span class="status-badge"
                                    [ngClass]="{'status-ativo': tv.ativo, 'status-inativo': !tv.ativo}">
                            {{ tv.ativo ? 'Ativo' : 'Inativo' }}
                        </span>
                    </td>
                    <td>
                        <div class="action-buttons" *ngIf="filtroStatus === 'ativos'">
                            <button class="btn-icon btn-edit" (click)="editarTelevisao(tv.idTelevisao!)" title="Editar">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                </svg>
                            </button>

                            <button class="btn-icon btn-delete-icon" (click)="abrirModalConfirmacao(tv.idTelevisao!, 'desativar')" title="Mover para Lixeira">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <polyline points="3 6 5 6 21 6"></polyline>
                                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                    <line x1="10" y1="11" x2="10" y2="17"></line>
                                    <line x1="14" y1="11" x2="14" y2="17"></line>
                                </svg>
                            </button>
                        </div>

                        <div class="action-buttons" *ngIf="filtroStatus === 'inativos'">
                            <button class="btn-icon btn-restore" (click)="abrirModalConfirmacao(tv.idTelevisao!, 'ativar')" title="Restaurar / Ativar">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <polyline points="1 4 1 10 7 10"></polyline>
                                    <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path>
                                </svg>
                            </button>
                        </div>
                    </td>
                </tr>
            </tbody>

            <ng-template #emptyState>
                <tbody>
                    <tr>
                        <td colspan="9" class="empty-state">
                            <p *ngIf="totalRegistros === 0 && !termoBusca; else noResults">
                                {{ filtroStatus === 'inativos' ? 'A lixeira de televisões está vazia.' : 'Nenhuma televisão cadastrada.' }}
                            </p>
                            <ng-template #noResults>
                                <p>Nenhuma televisão encontrada com o termo "{{ termoBusca }}".</p>
                            </ng-template>
                        </td>
                    </tr>
                </tbody>
            </ng-template>
        </table>
    </div>

    <div class="pagination-controls" *ngIf="totalRegistros > 0">
        <div class="page-size-selector">
            <label for="itensPorPagina">Itens por pág:</label>
            <select id="itensPorPagina" [(ngModel)]="itensPorPagina" (change)="onItensPorPaginaChange()">
                <option *ngFor="let size of opcoesItensPorPagina" [value]="size">
                    {{ size }}
                </option>
            </select>
        </div>

        <span class="page-info">
            <ng-container *ngIf="totalPaginas > 1">
                Página {{ paginaAtual }} de {{ totalPaginas }}
            </ng-container>
            ({{ totalRegistros }} {{ totalRegistros === 1 ? 'item' : 'itens' }})
        </span>

        <div class="page-buttons" *ngIf="totalPaginas > 1">
            <button class="page-button" (click)="paginaAnterior()" [disabled]="paginaAtual === 1">
                &lt; Anterior
            </button>
            <button class="page-button" (click)="proximaPagina()" [disabled]="paginaAtual === totalPaginas">
                Próxima &gt;
            </button>
        </div>
    </div>
</div>

<div id="deleteModal" class="modal" [class.active]="modalVisivel">
    <div class="modal-content">
        <h2>Confirmar {{ acaoModal === 'desativar' ? 'Desativação' : 'Restauração' }}</h2>
        <p>
            Tem certeza que deseja <strong>{{ acaoModal === 'desativar' ? 'desativar' : 'restaurar' }}</strong> esta televisão (ID: {{ televisaoParaExcluir }})?
        </p>
        <p *ngIf="acaoModal === 'desativar'" class="modal-warning">
            Ela será movida para a Lixeira e poderá ser restaurada posteriormente.
        </p>
        <div class="modal-actions">
            <button class="btn-cancel" (click)="fecharModal()">Cancelar</button>
            <button class="btn-delete" [ngClass]="{'btn-restore-confirm': acaoModal === 'ativar'}" (click)="confirmarExclusao()">
                {{ acaoModal === 'desativar' ? 'Desativar' : 'Restaurar' }}
            </button>
        </div>
    </div>
</div>
